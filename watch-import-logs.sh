#!/bin/bash
# Ð¡ÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð¼Ð¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³Ð° Ð»Ð¾Ð³Ð¾Ð² Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð° Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸

LOG_FILE="/tmp/backend-full.log"

# ÐŸÑ€Ð¾Ð²ÐµÑ€ÑÐµÐ¼ Ð½Ð°Ð»Ð¸Ñ‡Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ð°
if [ ! -f "$LOG_FILE" ]; then
    LOG_FILE="/tmp/backend-run.log"
fi

if [ ! -f "$LOG_FILE" ]; then
    echo "âŒ Ð›Ð¾Ð³ Ñ„Ð°Ð¹Ð»Ñ‹ Ð½Ðµ Ð½Ð°Ð¹Ð´ÐµÐ½Ñ‹!"
    echo "ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ñ‡Ñ‚Ð¾ Ð±ÑÐºÐµÐ½Ð´ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½"
    exit 1
fi

echo "ðŸ” ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð»Ð¾Ð³Ð¾Ð² Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð°..."
echo "ðŸ“‚ Ð¤Ð°Ð¹Ð»: $LOG_FILE"
echo ""
echo "ðŸ’¡ Ð¡Ð¾Ð²ÐµÑ‚: Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚ Ð² Ð±Ñ€Ð°ÑƒÐ·ÐµÑ€Ðµ, Ñ‡Ñ‚Ð¾Ð±Ñ‹ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ Ð»Ð¾Ð³Ð¸"
echo "â¹ï¸  ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ Ctrl+C Ð´Ð»Ñ Ð²Ñ‹Ñ…Ð¾Ð´Ð°"
echo ""
echo "=========================================="
echo ""

# ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÐ¼ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 20 ÑÑ‚Ñ€Ð¾Ðº Ñ Ð»Ð¾Ð³Ð°Ð¼Ð¸ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð°
echo "ðŸ“‹ ÐŸÐ¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ Ð»Ð¾Ð³Ð¸ Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚Ð°:"
grep -i "import\|MAP\|DEAL\|BATCH" "$LOG_FILE" 2>/dev/null | tail -20
echo ""
echo "=========================================="
echo "ðŸ”„ ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ Ð½Ð¾Ð²Ñ‹Ñ… Ð»Ð¾Ð³Ð¾Ð² (Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ Ctrl+C Ð´Ð»Ñ Ð²Ñ‹Ñ…Ð¾Ð´Ð°)..."
echo ""

# ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð¼ Ð½Ð¾Ð²Ñ‹Ðµ Ð»Ð¾Ð³Ð¸ Ñ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¼ Ð±ÑƒÑ„ÐµÑ€Ð¸Ð½Ð³Ð¾Ð¼
tail -f "$LOG_FILE" 2>/dev/null | grep --line-buffered -i "import\|MAP DEAL ROW RESULT\|IMPORT DEAL DATA\|BATCH CREATE DEAL DATA\|IMPORT REQUEST\|ðŸ”¥ IMPORT"



